<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Anime Detail</title>
  <style>
    body { font-family: sans-serif; background: #f9f9f9; padding: 2rem; }
    .container { max-width: 800px; margin: auto; background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 0 10px #ccc; }
    iframe { width: 100%; height: 400px; border: none; margin-top: 1rem; }
  </style>
</head>
<body>
  <div class="container" id="anime-detail">Loading...</div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const animeId = params.get('id');

    fetch('animes.json')
      .then(res => res.json())
      .then(data => {
        const anime = data.find(a => a.id === animeId);
        if (!anime) {
          document.getElementById('anime-detail').innerHTML = '<p>Anime not found.</p>';
          return;
        }

        // ✅ Cambiar el título del documento
        document.title = anime.name;

        const container = document.getElementById('anime-detail');
        container.innerHTML = `
          <h1>${anime.name}</h1>
          <img src="${anime.cover}" alt="${anime.name}" style="width:100%; border-radius:10px;">
          <p><strong>Genres:</strong> ${anime.genre.join(', ')}</p>
          <p><strong>Year:</strong> ${anime.year}</p>
          <p>${anime.description}</p>
          <div><strong>Episodes:</strong></div>
          <div id="ep-buttons"></div>
          <div id="video-container"></div>
        `;

        const epButtons = document.getElementById('ep-buttons');
        const videoContainer = document.getElementById('video-container');

        anime.episodes.forEach((ep, i) => {
          const btn = document.createElement('button');
          btn.textContent = `Episode ${ep.number}`;
          btn.style.margin = '0.5rem';
          btn.addEventListener('click', () => {
            const temp = document.createElement('div');
            temp.innerHTML = ep.embed;
            const iframe = temp.querySelector('iframe');
            if (iframe) {
              iframe.style.width = '100%';
              iframe.style.height = '400px';
              iframe.removeAttribute('width');
              iframe.removeAttribute('height');
              videoContainer.innerHTML = '';
              videoContainer.appendChild(iframe);
            } else {
              videoContainer.innerHTML = ep.embed;
            }
          });
          epButtons.appendChild(btn);
        });

        // Reproduce el primer episodio automáticamente
        if (anime.episodes.length > 0) {
          epButtons.children[0].click();
        }
      });
  </script>
</body>
</html>
